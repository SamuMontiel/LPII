<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Perfil - VirtualHub</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" th:href="@{/css/perfil.css}">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
</head>
<body class="profile-page">

	<!-- NAVBAR CORREGIDO -->
	<header class="steam-navbar">
	    <div class="navbar-container">
	        <div class="navbar-left">
	            <a th:href="@{/home}" class="navbar-logo">üéÆ <span>VirtualHub</span></a>
	            <nav class="navbar-tabs">
	                <a th:href="@{/home}" th:classappend="${activePage == 'home'} ? 'active' : ''" class="tab-item">TIENDA</a>
	                <a th:href="@{/biblioteca}" th:classappend="${activePage == 'biblioteca'} ? 'active' : ''" class="tab-item">BIBLIOTECA</a>
	                <a th:href="@{/comunidad}" th:classappend="${activePage == 'comunidad'} ? 'active' : ''" class="tab-item">COMUNIDAD</a>
	                <a th:href="@{/perfil}" th:classappend="${activePage == 'perfil'} ? 'active' : ''" class="tab-item">PERFIL</a>
	            </nav>
	        </div>
	        <div class="navbar-right">
	            <div class="saldo-pill">
	                <i class="fas fa-wallet"></i> S/ <span th:text="${#numbers.formatDecimal(usuario.saldo,1,2)}"></span>
	            </div>
	            <form th:action="@{/logout}" method="post" class="logout-form">
	                <button type="submit" class="logout-btn">Cerrar sesi√≥n</button>
	            </form>
	        </div>
	    </div>
	</header>

<!-- HERO BANNER -->
<div class="steam-profile-hero" 
     th:style="'background-image: url(' + (${juegoMasJugado != null ? juegoMasJugado.juego.bannerUrl : '/images/banners/cyberpunk2077-banner.jpg'}) + ')'">

    <!-- AVATAR M√ÅS PEQUE√ëO Y CENTRADO A LA IZQUIERDA -->
    <div class="avatar-container">
        <div class="avatar-frame">
            <img src="/images/hogwarts-legacy.jpg" alt="Avatar">
        </div>
    </div>

    <div class="hero-content">
        <h1 class="hero-name" th:text="${#strings.toUpperCase(usuario.nombre)}"></h1>
        <p class="real-name" th:text="${usuario.nombre}"></p>
        
        <div class="most-played">
            El juego m√°s jugado es: 
            <strong th:text="${juegoMasJugado != null ? juegoMasJugado.juego.titulo : 'Ninguno'}"></strong>
        </div>
        
        <button class="btn-edit-profile">MODIFICAR PERFIL</button>
    </div>
</div>

<!-- CONTENIDO -->
<div class="main-container">
    <div class="profile-grid">
        <!-- SIDEBAR IZQUIERDA -->
        <div class="sidebar">
            <div class="sidebar-card">
                <h4>Nivel <span class="level">3</span></h4>
                <div class="xp-bar"><div class="xp-fill"></div></div>
            </div>
            <div class="sidebar-card">
                <h5>Estad√≠sticas</h5>
                <p>Total juegos: <strong th:text="${biblioteca.size()}"></strong></p>
                <p>Juego favorito: <strong th:text="${juegoMasJugado != null ? juegoMasJugado.juego.titulo : 'Ninguno'}"></strong></p>
            </div>
            <div class="sidebar-card">
                <h5>Amigos</h5>
                <p>‚Ä¢ Wyoxiel <span class="status online">En l√≠nea</span></p>
                <p>‚Ä¢ ITS-RAINING <span class="status offline">Desconectado</span></p>
            </div>
        </div>

        <!-- CENTRO - ACTIVIDAD RECIENTE -->
        <div class="activity-section">
            <h3 class="section-title">Actividad Reciente</h3>
            <div th:each="uj : ${biblioteca}" th:if="${uj != null and uj.juego != null}" class="activity-card-modern">
                <img th:src="@{${uj.juego.coverUrl}}" class="activity-cover" 
                     onerror="this.src='/images/covers/cyberpunk2077-cover.jpg'">
                <div class="activity-info">
                    <h4 th:text="${uj.juego.titulo}"></h4>
                    <p th:text="${uj.juego.descripcion}"></p>
                    <div class="activity-meta">
                        <span th:text="${#numbers.formatDecimal(uj.horasJugadas,1,1)} + ' horas jugadas'"></span>
                        <span>‚Ä¢ √öltima sesi√≥n: <span th:text="${#temporals.format(uj.ultimaSesion,'dd MMM')}"></span></span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<footer class="footer">VirtualHub ¬© 2026 ‚Ä¢ Hecho con ‚ù§Ô∏è por Samuel</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>