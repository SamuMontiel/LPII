<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Biblioteca - VirtualHub</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>

<div class="library-container">
    <div class="library-sidebar">
        <h2>Biblioteca</h2>

        <div th:each="juego : ${juegos}"
             class="library-item"
             onclick="mostrarJuego(this)"
             th:data-titulo="${juego.titulo}"
             th:data-descripcion="${juego.descripcion}"
             th:data-imagen="${juego.imagenUrl}">

            <span th:text="${juego.titulo}"></span>
        </div>
    </div>
    <div class="library-detail">
        <div id="detalleContenido">
            <h1>Selecciona un juego</h1>
            <p>Haz click en un juego de tu biblioteca</p>
        </div>
    </div>

</div>

<script>

function mostrarJuego(elemento) {
    document.querySelectorAll(".library-item")
        .forEach(item => item.classList.remove("activo"));

    elemento.classList.add("activo");

    const titulo = elemento.dataset.titulo;
    const descripcion = elemento.dataset.descripcion;
    const imagen = elemento.dataset.imagen;
    const rating = (Math.random() * 5).toFixed(1);
    const horas = (Math.random() * 200).toFixed(1);
    const porcentaje = (rating / 5) * 100;

    document.querySelector(".library-detail").style.background =
        `linear-gradient(rgba(15,20,27,0.85), rgba(15,20,27,0.95)), url('${imagen}') center/cover no-repeat`;

    document.getElementById("detalleContenido").innerHTML = `
        <div class="detalle-header">
            <img src="${imagen}" class="library-img">

            <div class="detalle-info">
                <h1>${titulo}</h1>
                <p class="detalle-descripcion">${descripcion}</p>

                <div class="stats">
                    <p>‚òÅ Estado en la nube: <span class="ok">Actualizado</span></p>
                    <p>üïí √öltima sesi√≥n: Hace 2 d√≠as</p>
                    <p>‚è≥ Tiempo total jugado: ${horas} hrs</p>
                    <p>‚≠ê Valoraci√≥n: ${rating} / 5</p>
                </div>

                <div class="barra-aprobacion">
                    <div class="barra-fill" style="width:${porcentaje}%"></div>
                </div>

                <button class="btn-jugar" onclick="launchGame(this)">
                    JUGAR
                </button>
            </div>
        </div>
    `;
}

function launchGame(btn){
    btn.innerText = "Iniciando...";
    btn.classList.add("launching");

    setTimeout(() => {
        btn.innerText = "Jugando...";
    }, 1500);
}

</script>

</body>
</html>